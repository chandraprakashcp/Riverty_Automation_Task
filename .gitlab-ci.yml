stages:
  - test

variables:
  DOTNET_CLI_TELEMETRY_OPTOUT: "1"

before_script:
  - dotnet --version
  - dotnet restore

api-tests:
  stage: test
  script:
    - echo "Running Booking API Tests on Windows Runner..."
    - dotnet build --no-restore
    - dotnet test --logger "console;verbosity=normal" --no-build
    - echo "Tests completed! Searching for ExtentReports..."
    - dir /s *.html || echo "No HTML reports found"
    - dir /s TestReports || echo "No TestReports directory found"
    - dir /s bin || echo "Checking bin directory"
  artifacts:
    when: always
    paths:
      - bin/**/*.html
      - TestReports/
      - *.html
    expire_in: 1 week
  only:
    - main
  tags:
    - api